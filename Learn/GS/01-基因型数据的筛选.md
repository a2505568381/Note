[TOC]
# 基因型数据的清洗
## 1.筛选的标准
### 1.1 去除1.1 去除缺失率大于10%的SNP位点
如有50K个SNP位点，1000个体，如果某一个SNP位点在1000个体中，缺失率达到10%以上，即有超过100的个体在这个SNP位点上没有分型结果，就把这个位点删除。避免这些缺失率大的SNP降低后期填充的准确性。

### 1.2 样本检出率大于90%
比如共有50K的芯片，需要个体的芯片分型数要大于45K，否则去掉该样本。

### 1.3 最小等位基因频率（MAF）大于1%
我们在进行基因组选择（SS-GBLUP）时，需要构建G矩阵和H矩阵，构建G矩阵是利用SNP的分型信息。构建好的G矩阵描述的是个体间的关系，如果一个位点在999个个体上都为A，在1个个体上为G，即MAF为0.1%，这种SNP位点在计算中意义不大，去掉可以节约计算资源。

### 1.4 去除哈迪温伯格平衡检验(HWE)P值为$10^{-6}$的SNP位点
在对位点进行哈温平衡检验时，去除P值小于10^(-6)的SNP位点



## 2.PLINK格式
### 2.1 map文件
>格式说明链接:
>http://zzz.bwh.harvard.edu/plink/data.shtml#map

map格式的文件，图谱信息文件, 主要包括染色体名称、SNP名称、所在染色体的遗传坐标和物理坐标。

map文件没有行头，包括四列: 染色体、SNP名称、SNP位置、碱基对坐标。

第一列：染色体编号为数字, 未知为0
第二列：SNP名称为字符或数字, 如果不重要, 可以从1编号, 注意要和bed文件SNP列对应
第三列：染色体的摩尔位置(如果未知，可以用0表示)
第四列：SNP物理坐标

如果只有SNP名称, 可以手动构建map文件, 第二列为SNP名称, 其它几列如果未知，可以写为0。

图片

### 2.2 ped文件

>格式说明链接:
>http://zzz.bwh.harvard.edu/plink/data.shtml#ped

bed格式的文件, 主要包括SNP的信息、包括个体ID、系谱信息、表型和SNP的分型信息。

数据没有行头, 空格或者tab隔开的文件。前六列必须有, 包括系谱信息, 表型信息。

第一列: Family ID # 如果没有, 可以用个体ID代替
第二列: Individual ID # 个体ID编号
第三列:  Paternal ID # 父本编号
第四列:   Maternal ID # 母本编号
第五列:   Sex (1=male; 2=female; other=unknown) # 性别, 如果未知, 用0表示
第六列:   Phenotype # 表型数据, 如果未知, 用0表示
第七列以后: 为SNP分型数据, 可以是AT CG或11 12, 或者A T C G或1 1 2 2

注意：前六列, 必须要有, 如果没有相关数据, 用0表示。


## 3. PLINK过滤命令
### 3.1 缺失大于10%
```bash
--geno 0.1
```
### 3.2 样本call rate大于90%
```bash
--mind 0.1
```
3.3 最小等位基因频率大于0.01
```bash
--maf 0.1
```
3.4 哈温平衡P值大于1e-6
```bash
--hwe 1e-6
```
3.5 输出过滤后的012形式的文件
```bash
--recodeA
```
3.6 将过滤后的文件命名为c
```bash
--out c
```

## 4. 测试数据

4.1 预览文件

(base) [dengfei@localhost test]$ ls
b.map  b.ped
4.2 使用plink进行处理

plink --file b --chr-set 30  --geno 0.1 --mind 0.1 --maf 0.01 --hwe 1e-6 --recodeA  --out c
4.3 处理结果日志
